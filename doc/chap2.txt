  
  [1X2 [33X[0;0YEgg-Box Diagrams[133X[101X
  
  
  [1X2.1 [33X[0;0YPreliminaries: Green's relations[133X[101X
  
  [33X[0;0YLet  [23XS[123X be a semigroup and let [23XS^1[123X be the monoid corresponding to [23XS[123X, which is
  the same as [23XS[123X plus an identity element if and only if [23XS[123X doesn't already have
  one.  Write  [23XS^1a[123X for the principal left ideal generated by any element [23Xa\in
  S[123X,  which  is  the  set [23X\left\{ sa \mid s\in S^1 \right\}[123X. Similarly, we let
  [23XaS^1[123X  mean  [23X\left\{  as \mid s\in S^1 \right\}[123X, a principal right ideal, and
  [23XS^1aS^1[123X  mean  [23X\left\{ sas' \mid s,s'\in S^1 \right\}[123X, a principal two-sided
  ideal.[133X
  
  [33X[0;0YWe  are now in a position to define Green's relations, which are what define
  how  an  "egg-box diagram" is structured. Each of the five relations defined
  below,  [23XL,R,J,D,H[123X,  is  a  binary  equivalence  relation  on [23XS[123X (although the
  definitions use the ideals given above, which leverage [23XS^1[123X). We do not prove
  here   that   these  are  equivalence  relations;  consider  this  just  the
  preliminaries needed to define the visualization.[133X
  
  [30X    [33X[0;6YLet [23XaLb[123X hold iff [23XaS^1=bS^1[123X.[133X
  
  [30X    [33X[0;6YLet [23XaRb[123X hold iff [23XS^1a=S^1b[123X.[133X
  
  [33X[0;0YBecause  these  are  equivalence  relations,  if we have some [23Xa\in S[123X, we may
  refer to its equivalence class under [23XL[123X or [23XR[123X by [23X[a]_L[123X or [23X[a]_R[123X, respectively.[133X
  
  [30X    [33X[0;6YLet [23XaJb[123X hold iff [23XS^1aS^1=S^1bS^1[123X.[133X
  
  [30X    [33X[0;6YLet [23XaHb[123X hold iff [23XaLb[123X and [23XaRb[123X.[133X
  
  [30X    [33X[0;6YLet [23XaDb[123X hold iff [23X[a]_R\cap[b]_L\neq\emptyset[123X.[133X
  
  [33X[0;0YThe coarsest of these five relations is [23XD[123X and for any given [23Xa,b\in S[123X, if any
  of [23XaLb,aRb,aJb,aHb[123X holds then [23XaDb[123X holds.[133X
  
  [33X[0;0YWithin any given [23XD[123X-class, the relations [23XL[123X and [23XR[123X function on different "axes"
  so  to  speak.  All [23X[a]_L[123X within a given [23XD[123X-class are the same size; the same
  holds  for  all  [23X[a]_R[123X  in  each  [23XD[123X-class.  And  because [23XH[123X is defined as the
  conjunction   of  [23XL[123X  and  [23XR[123X,  the  parts  of  its  partition  are  just  the
  intersections of [23X[a]_L[123X and [23X[a]_R[123X classes. This happens uniformly within each
  [23XD[123X-class, so all [23XH[123X-classes in a [23XD[123X-class have the same size.[133X
  
  [33X[0;0YThis  suggests  dividing up the semigroup into [23XD[123X-classes, then dividing each
  [23XD[123X-class  into [23XH[123X-classes, organized into a table of rows and columns with the
  rows  corresponding  to [23XR[123X-classes and the columns to [23XL[123X-classes. Each [23XD[123X-class
  is  a grid of little bins (the [23XH[123X-classes), which gives rise to the notion of
  an "egg box" (or "egg carton"), since they, too, are grids of little bins.[133X
  
  [33X[0;0YImage of an egg box/carton not available in this medium.[133X
  
  
  [1X2.2 [33X[0;0YGenerating egg-box diagrams[133X[101X
  
  [33X[0;0YAs  an  example,  consider  the  semigroup of non-invertible transformations
  generated  by  the  six  idempotents  of  degree 3 and rank 2, which you can
  compute with the following [5XGAP[105X code.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28XLoadPackage( "semigroups" );[128X[104X
    [4X[28XS := SingularTransformationSemigroup( 3 );[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThen its egg-box diagram looks like the following.[133X
  
  [33X[0;0YImage of an egg-box diagram not available in this medium.[133X
  
  [33X[0;0YThe diagram is clearly composed of two distinct components, each of which is
  a grid of cells, and thus each is like an "egg box."[133X
  
  [33X[0;0YThis  image  was  generated using this package. If you have already executed
  the code above to define the semigroup [10XS[110X, you could generate an image of the
  same semigroup with the following code.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28XLoadPackage( "semigroupviz" );[128X[104X
    [4X[28XShowEggBoxDiagram( S );[128X[104X
  [4X[32X[104X
  
  [33X[0;0Y(Technically,  that  code  will generate a much more verbose figure. See the
  Section [14X2.3[114X for details.)[133X
  
  [33X[0;0YNote the following structure within that image.[133X
  
  [30X    [33X[0;6YEach large block is a [23XD[123X-class.[133X
  
  [30X    [33X[0;6YEach row within a [23XD[123X-class is an [23XR[123X-class.[133X
  
  [30X    [33X[0;6YEach column within a [23XD[123X-class is an [23XL[123X-class.[133X
  
  [30X    [33X[0;6YEach cell within a [23XD[123X-class is an [23XH[123X-class.[133X
  
  [30X    [33X[0;6YEach  line  within  an  [23XH[123X-class cell is an element of that [23XH[123X-class. In
        this  particular  case,  each  element  is  represented  as  a list of
        positive integers. For example, the first element of the first [23XH[123X-class
        is [10X[ 1, 2, 2 ][110X.[133X
  
  [33X[0;0YThe figure below summarizes these facts visually.[133X
  
  [33X[0;0YImage  of  an  egg-box  diagram  with  classes labeled not available in this
  medium.[133X
  
  
  [1X2.3 [33X[0;0YFormatting element names[133X[101X
  
  [33X[0;0YIf  the  elements  of your semigroup have a compact representation, then the
  [2XShowEggBoxDiagram[102X  ([14X4.1-1[114X)  function  introduced in Section [14X2.2[114X will produce
  readable  diagrams.  But  if  the  elements  of the semigroup have very long
  names,  then each [23XH[123X-class will be very wide, making the diagram less compact
  and readable.[133X
  
  [33X[0;0YTo solve this problem, you can provide a function that maps elements of your
  semigroup to whatever (typically more compact) notation you'd like to use in
  the  diagram.  You  pass  this  as  one  of the options to [2XShowEggBoxDiagram[102X
  ([14X4.1-1[114X), under the name [10XToString[110X.[133X
  
  [33X[0;0YFor  instance,  the  elements  of  the  semigroup  shown  in Section [14X2.2[114X are
  [10XTransformation[110Xs,  which  can be shown compactly by converting them to a list
  and then from there to a string. The image in that section was made with the
  following code.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28XShowEggBoxDiagram([128X[104X
    [4X[28X  SingularTransformationSemigroup( 3 ),[128X[104X
    [4X[28X  rec( ToString := elt -> String( ListTransformation( elt ) ) )[128X[104X
    [4X[28X);[128X[104X
  [4X[32X[104X
  
  [33X[0;0YDetailed  documentation  of all the options of the [2XShowEggBoxDiagram[102X ([14X4.1-1[114X)
  function can be found in its documentation in Section [14X4[114X.[133X
  
  
  [1X2.4 [33X[0;0YInteracting with egg-box diagrams[133X[101X
  
  [33X[0;0YSemigroups  can  be  of  arbitrary  size, and if they become too large, then
  diagrams  become infeasible or unhelpful to view. Thus this package provides
  some  ways  to  compute only a portion of a diagram or to hide sections of a
  diagram as needed. This section of the manual covers these features.[133X
  
  
  [1X2.4-1 [33X[0;0YGenerating only a portion of a diagram[133X[101X
  
  [33X[0;0YIn  the  documentation  for  [2XShowEggBoxDiagram[102X ([14X4.1-1[114X), you can see that the
  options  object  permits you to provide options entitled [10XNrDClassesIncluded[110X,
  [10XNrRClassesIncludedPerDClass[110X,         [10XNrLClassesIncludedPerRClass[110X,        and
  [10XNrElementsIncludedPerHClass[110X.  These  options  govern how much data should be
  computed by [5XGAP[105X and included in the HTML that shows the egg-box diagram.[133X
  
  [33X[0;0YThe  purpose  of  these  features should be clear by considering a semigroup
  containing  more  than  one  billion  elements. (Such semigroups are easy to
  create with a single function call in [5XGAP[105X.) Each element takes several bytes
  to  represent, and thus the HTML generated to display such a semigroup would
  be  many gigabytes of data. And yet humans cannot visually process every one
  of the billion elements, so we just want to see the overall structure of the
  semigroup.  Thus it is not necessary for [5XGAP[105X to create HTML containing every
  detail  of  every  [23XH[123X-class  and  all its elements. It would be sufficient to
  include  several  example  [23XD[123X-classes,  each  with  several  example rows and
  columns, and each resulting [23XH[123X-class showing several example elements.[133X
  
  [33X[0;0YYou  can  govern  just  how  many  [23XD[123X-, [23XL[123X-, and [23XR[123X-classes are included in the
  generated  diagram,  as  well  as  how  many  elements  are included in each
  [23XH[123X-class,  using the options mentioned above. The diagram will make it clear,
  when  you  are  viewing it, that there are additional elements not available
  for viewing, because [5XGAP[105X did not provide them to the web page to display.[133X
  
  [33X[0;0YEven  after executing the code to generate a diagram, the viewer has control
  over  how many of each type of class is displayed. The top right hand corner
  of  the  diagram  contains  a settings icon and clicking it reveals a set of
  controls like those shown below. (Clicking it again hides them.)[133X
  
  [33X[0;0YImage of a diagram's settings controls not available in this medium.[133X
  
  [33X[0;0YOn  the  left,  you  can  see  a slider that controls how many [23XD[123X-classes are
  shown,  as described in Section [14X2.4-2[114X. Its minimum is one and maximum is the
  number  of [23XD[123X-classes [5XGAP[105X provided when generating the diagram. In this case,
  that  maximum  is  four, which is also the actual number of [23XD[123X-classes in the
  semigroup.  (If  it  were  not, the diagram would include an obvious warning
  about the missing data; see below.)[133X
  
  [33X[0;0YYou  can  also  see  options for when to show the headings in an [23XH[123X-class, as
  documented in Section [14X2.4-2[114X.[133X
  
  [33X[0;0YOn  the  right,  you  can see a box that lets you customize the settings for
  each  [23XD[123X-class  separately. Choosing a [23XD[123X-class from the drop-down list at the
  top  of  that section updates all the controls below to reflect the settings
  you last specified for that class.[133X
  
  [33X[0;0YThe  sliders function as described in Section [14X2.4-2[114X. The minimum for each is
  always one but the maximum is determined by the data included in the diagram
  by  [5XGAP[105X.  This may be the actual number of [23XL[123X- or [23XR[123X-classes in the semigroup,
  or  the actual number of elements in an [23XH[123X-class, or it may be less than that
  number  if  [5XGAP[105X  provided only a subset of the semigroup when generating the
  diagram's data.[133X
  
  [33X[0;0YIn that latter case, the interface makes it obvious, as you can see with the
  bright  blue  box  at the bottom right of the above image. It warns the user
  that  the  [23XH[123X-class  slider  has  a  maximum  of 20 because the [5XGAP[105X code that
  generated  this  diagram  included only 20 elements per [23XH[123X-class, even though
  there are actually 24 elements per [23XH[123X-class in this particular [23XD[123X-class in the
  semigroup itself.[133X
  
  [33X[0;0YNo  such bright blue boxes appear under the sliders for the [23XR[123X- or [23XL[123X-classes,
  meaning  that  in  this  particular  [23XD[123X-class,  every  [23XR[123X-  and [23XL[123X-class in the
  semigroup has been provided by [5XGAP[105X to the diagram for viewing.[133X
  
  [33X[0;0YIf  you  want  to make such warnings go away, so that all (or at least more)
  elements  are  included in the diagram, you must regenerate the diagram with
  another call to [2XShowEggBoxDiagram[102X ([14X4.1-1[114X), this time providing larger values
  for the relevant option(s), [10XNrDClassesIncluded[110X, [10XNrRClassesIncludedPerDClass[110X,
  [10XNrLClassesIncludedPerRClass[110X, and/or [10XNrElementsIncludedPerHClass[110X.[133X
  
  
  [1X2.4-2 [33X[0;0YExpanding and contracting diagrams[133X[101X
  
  [33X[0;0YWhile  viewing  an  egg-box  diagram,  the following interactive options are
  available to you.[133X
  
  [33X[0;0YIf  you show the settings controls documented in Section [14X2.4-1[114X, then you can
  interact with those controls as follows.[133X
  
  [30X    [33X[0;6YThe slider entitled "Show this many [23XD[123X-classes:" can be dragged to show
        or  hide [23XD[123X-classes. The diagram updates as you drag the slider. If you
        move  this  slider  below  its maximum, then a note is included at the
        bottom right of the diagram, indicating that there are other [23XD[123X-classes
        not shown.[133X
  
        [33X[0;6YRegardless  of  whether the settings controls are shown or hidden, you
        can  click such a message to expose all available hidden [23XD[123X-classes. To
        reverse such an action, use the slider.[133X
  
  [33X[0;0YImage of the "more D-classes" message not available in this medium.[133X
  
  [30X    [33X[0;6YThe  radio  buttons  allow  you to choose when to include a heading in
        [23XH[123X-classes:[133X
  
        [30X    [33X[0;12YAlways:  Every  [23XH[123X-class in the diagram will begin with a heading
              stating its size, such as "15 elements:".[133X
  
        [30X    [33X[0;12YNever: No [23XH[123X-class in the diagram will begin with a heading; only
              the elements are shown.[133X
  
        [30X    [33X[0;12YWhen  needed: Each [23XH[123X-class in the diagram is treated separately.
              A  heading stating the number of elements is omitted if and only
              if  all  elements  are  shown.  That is, the diagram reports the
              number  of  elements  only if it cannot be deduced visually from
              the cell.[133X
  
  [30X    [33X[0;6YThe  drop-down  list entitled "Choose a [23XD[123X-class by representative:" is
        present because the right-hand section of the diagram settings are not
        global,  but local within each [23XD[123X-class. First choose the [23XD[123X-class whose
        settings you will edit, then proceed to adjust those settings with the
        controls  beneath  the  drop-down list. Choosing a new [23XD[123X-class updates
        the  controls  to  reflect  the  settings  you've already set for that
        class.[133X
  
  [30X    [33X[0;6YThe  slider  for the number of [23XR[123X-classes to show determines the number
        of rows that will be shown in the chosen [23XD[123X-class. If you do not choose
        to  show  all [23XR[123X-classes in the [23XD[123X-class, then the [23XD[123X-class will end with
        an ellipsis and a message indicating that there are some [23XR[123X-classes not
        shown.[133X
  
        [33X[0;6YRegardless  of  whether the settings controls are shown or hidden, you
        can  click  such  a  message  to expose all available hidden [23XR[123X-classes
        within a [23XD[123X-class. To reverse such an action, use the slider.[133X
  
  [33X[0;0YImage of the "more R-classes" message not available in this medium.[133X
  
  [30X    [33X[0;6YThe  slider  for the number of [23XL[123X-classes to show determines the number
        of  columns  that  will  be shown in the chosen [23XD[123X-class. If you do not
        choose  to  show  all [23XL[123X-classes in the [23XD[123X-class, then each row will end
        with  an  ellipsis  and  a  message  indicating  that  there  are some
        [23XL[123X-classes not shown.[133X
  
        [33X[0;6YRegardless  of  whether the settings controls are shown or hidden, you
        can  click  such  a  message  to expose all available hidden [23XL[123X-classes
        within a [23XD[123X-class. To reverse such an action, use the slider.[133X
  
  [33X[0;0YImage of the "more L-classes" message not available in this medium.[133X
  
  [30X    [33X[0;6YThe slider for the number of elements to show determines the number of
        lines that will be shown in each cell ([23XH[123X-class) of the chosen [23XD[123X-class.
        If  you  do not choose to show all elements in each [23XH[123X-class, then each
        cell will end with an ellipsis indicating that there are some elements
        not shown.[133X
  
        [33X[0;6YRegardless  of  whether the settings controls are shown or hidden, you
        can  click  such  a  message  to  expose all available hidden elements
        within an [23XH[123X-class. To reverse such an action, use the slider.[133X
  
  [33X[0;0YImage of the "more elements" ellipsis not available in this medium.[133X
  
  [33X[0;0YThere  are  other  ways  to  interact  with  the  diagram  using your mouse,
  independent  of  the  settings controls. These features function whether the
  settings controls are open or closed.[133X
  
  [30X    [33X[0;6YHovering  your  mouse  over  any cell in the diagram will list all the
        elements included in that [23XH[123X-class, even if not all are currently being
        shown  in  the cell. This way you can keep the diagram of a manageable
        size  for  high-level viewing, but drill down by hovering on any given
        cell.[133X
  
  [30X    [33X[0;6YClicking  on the elements shown in any cell in the diagram will expand
        just that cell to include all known elements in that [23XH[123X-class. Clicking
        again  will  collapse  it to show just the number you've chosen in the
        settings, as indicated above.[133X
  
